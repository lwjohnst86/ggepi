<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to ggepi • ggepi</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to ggepi">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ggepi</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ggepi.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/lwjohnst86/ggepi">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Introduction to ggepi</h1>
                        <h4 class="author">Luke W. Johnston</h4>
            
            <h4 class="date">2018-03-27</h4>
      
      <small>Source: <a href="https://github.com/lwjohnst86/ggepi/blob/master/vignettes/ggepi.Rmd"><code>vignettes/ggepi.Rmd</code></a></small>

    </div>

    
    
<div class="contents">
<p>The main aim of the ggepi package is to provide ggplot2 layers for common statistical presentations (at least in epidemiology and at least what I use often). The ggepi package is as hands off as possible. This package assumes what you want to plot is what you want to plot, and lets you have full control over how the plot of the results looks like. When it comes to your data or results you want to plot, all of the work is done by you and done before plotting. The reason I created this package and these functions is because many of the other packages that have similar functionality assume too many things about what data you want to plot and how the plot will look… and it is very difficult to change how these settings. The other thing about other packages is that they don’t make use of ggplot2 ability to <a href="https://cran.r-project.org/web/packages/ggplot2/vignettes/extending-ggplot2.html">extend and add layers</a>. This package creates new geom layers that provide all the full customizability of ggplot2 in a convenient wrapper for common ways of plotting certain types of results. There are of course trade offs to this different way of doing things! After each section there is a list of similar packages. Try the different packages out yourself and find out what works for you!</p>
<div id="estimates-and-confidence-intervals-from-regression-models" class="section level1">
<h1 class="hasAnchor">
<a href="#estimates-and-confidence-intervals-from-regression-models" class="anchor"></a>Estimates and confidence intervals from regression models</h1>
<p>In most cases, showing a figure of some results is more impactful than showing a table. Often times in epidemiology, results from analyses are put into a table. This is less then ideal for busy researchers, as it takes longer to process and understand the results from a table than it is from a figure. So, for presenting results from a regression type anaylsis (something that creates an estimate and a confidence interval) you can use the <code><a href="../reference/geom_estci.html">geom_estci()</a></code> layer.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(broom)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">fit &lt;-<span class="st"> </span><span class="kw">lm</span>(Fertility <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Catholic <span class="op">+</span><span class="st"> </span>Agriculture <span class="op">+</span><span class="st"> </span>Examination <span class="op">+</span><span class="st"> </span>Education <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="st">              </span>Infant.Mortality, <span class="dt">data =</span> swiss)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">fit &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/broom/topics/tidy">tidy</a></span>(fit, <span class="dt">conf.int =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co"># A quick look at the data:</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6">knitr<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/knitr/topics/kable">kable</a></span>(fit)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">conf.low</th>
<th align="right">conf.high</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Catholic</td>
<td align="right">0.1170662</td>
<td align="right">0.0485962</td>
<td align="right">2.408958</td>
<td align="right">0.0204621</td>
<td align="right">0.0189951</td>
<td align="right">0.2151373</td>
</tr>
<tr class="even">
<td align="left">Agriculture</td>
<td align="right">0.1110005</td>
<td align="right">0.0742354</td>
<td align="right">1.495250</td>
<td align="right">0.1423257</td>
<td align="right">-0.0388126</td>
<td align="right">0.2608135</td>
</tr>
<tr class="odd">
<td align="left">Examination</td>
<td align="right">0.4440591</td>
<td align="right">0.3143526</td>
<td align="right">1.412615</td>
<td align="right">0.1651367</td>
<td align="right">-0.1903301</td>
<td align="right">1.0784483</td>
</tr>
<tr class="even">
<td align="left">Education</td>
<td align="right">-0.7067362</td>
<td align="right">0.2500898</td>
<td align="right">-2.825930</td>
<td align="right">0.0071866</td>
<td align="right">-1.2114378</td>
<td align="right">-0.2020346</td>
</tr>
<tr class="odd">
<td align="left">Infant.Mortality</td>
<td align="right">2.9836617</td>
<td align="right">0.3168272</td>
<td align="right">9.417315</td>
<td align="right">0.0000000</td>
<td align="right">2.3442785</td>
<td align="right">3.6230449</td>
</tr>
</tbody>
</table>
<p>Using the <code>geom_estci</code> layer, you have fine-grained control of what it will look like.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">ggplot</span>(fit, <span class="kw">aes</span>(<span class="dt">x =</span> estimate, <span class="dt">y =</span> term, <span class="dt">xmin =</span> conf.low, <span class="dt">xmax =</span> conf.high)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="st">    </span><span class="kw"><a href="../reference/geom_estci.html">geom_estci</a></span>()</a></code></pre></div>
<p><img src="ggepi_files/figure-html/basic_estci-1.png" width="672" style="display: block; margin: auto;"></p>
<p>There is a utility function <code>discrete_pvalue</code> to convert a numeric p-value into a factor, which makes it easier to visualize the results. So:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">fit2 &lt;-<span class="st"> </span><span class="kw">transform</span>(fit, <span class="dt">p.value =</span> <span class="kw"><a href="../reference/discrete_pvalue.html">discrete_pvalue</a></span>(fit<span class="op">$</span>p.value))</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"></a>
<a class="sourceLine" id="cb3-3" data-line-number="3">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(fit2, <span class="kw">aes</span>(<span class="dt">x =</span> estimate, <span class="dt">y =</span> term, <span class="dt">xmin =</span> conf.low, <span class="dt">xmax =</span> conf.high,</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">                 <span class="dt">alpha =</span> p.value, <span class="dt">size =</span> p.value)) </a>
<a class="sourceLine" id="cb3-5" data-line-number="5">p <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/geom_estci.html">geom_estci</a></span>(<span class="dt">fatten =</span> <span class="dv">1</span>, <span class="dt">center.linetype =</span> <span class="st">"dotted"</span>)</a></code></pre></div>
<p><img src="ggepi_files/figure-html/discrete_pval-1.png" width="672" style="display: block; margin: auto;"></p>
<p>We can add ends to the error bars too.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">p <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/geom_estci.html">geom_estci</a></span>(<span class="dt">fatten =</span> <span class="dv">1</span>, <span class="dt">center.linetype =</span> <span class="st">"dotted"</span>, <span class="dt">height =</span> <span class="fl">0.5</span>, <span class="dt">linetype =</span> <span class="st">"dashed"</span>)</a></code></pre></div>
<p><img src="ggepi_files/figure-html/misc_edits_estci-1.png" width="672" style="display: block; margin: auto;"></p>
<p>All of the power of ggplot2 is available to customize the <code>geom_estci</code> layer. Check out the documentation for the <code>geom_estci</code> function (via <code>?</code>) as well as the ggplot2 layers e.g. <code>geom_pointrange</code> or <code>geom_point</code> for full customization. Since this is a ggplot2 object, you can add to it all you want, like using <code>facet_grids</code>.</p>
<div id="similar-packages" class="section level2">
<h2 class="hasAnchor">
<a href="#similar-packages" class="anchor"></a>Similar packages</h2>
<p>There are a few packages that have similar functionality as the e.g. <code>geom_estci</code>, but each has its own specific use cases:</p>
<ul>
<li>
<a href="https://cran.r-project.org/package=dotwhisker">dotwhisker</a> package</li>
<li>
<a href="https://ggobi.github.io/ggally/">GGally</a> package</li>
</ul>
<p>In both of these packages, they assume you’ll plot <em>directly</em> from the <code>lm</code> or other regression function, so they do a lot of internal data wrangling and managing.</p>
</div>
</div>
<div id="dimensionality-reduction-techniques" class="section level1">
<h1 class="hasAnchor">
<a href="#dimensionality-reduction-techniques" class="anchor"></a>Dimensionality reduction techniques</h1>
<div id="correlation-circle" class="section level2">
<h2 class="hasAnchor">
<a href="#correlation-circle" class="anchor"></a>Correlation circle</h2>
<p>For dimensionality reduction techniques, often it is useful to look at the correlation circle plots. These plots show the correlation between the original values and the scores (or component scores or components or factors) to get a sense of what is going on in the data. So, let’s set up the data.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">library</span>(pls)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt; Attaching package: 'pls'</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt; The following object is masked from 'package:stats':</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt;     loadings</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="kw">data</span>(yarn)</a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co"># Set up data to plot. We need to manually calculate the correlations and then</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co"># wrangle the results into the appropriate form (with components columns and the</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co"># variable name column)</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11">fit &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/pls/topics/mvr">plsr</a></span>(density <span class="op">~</span><span class="st"> </span>NIR, <span class="dt">data =</span> yarn)</a>
<a class="sourceLine" id="cb5-12" data-line-number="12">fit &lt;-<span class="st"> </span><span class="kw">cor</span>(<span class="kw">model.matrix</span>(fit), <span class="kw"><a href="http://www.rdocumentation.org/packages/pls/topics/scores">scores</a></span>(fit)[, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">drop =</span> <span class="ot">FALSE</span>])</a>
<a class="sourceLine" id="cb5-13" data-line-number="13">fit &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(fit)</a>
<a class="sourceLine" id="cb5-14" data-line-number="14">fit<span class="op">$</span>Variables &lt;-<span class="st"> </span><span class="kw">rownames</span>(fit)</a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="kw">rownames</span>(fit) &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="kw">colnames</span>(fit)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"Comp1"</span>, <span class="st">"Comp2"</span>)</a>
<a class="sourceLine" id="cb5-17" data-line-number="17"></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="co"># A quick look at the results:</span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19">knitr<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/knitr/topics/kable">kable</a></span>(<span class="kw">head</span>(fit))</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">Comp1</th>
<th align="right">Comp2</th>
<th align="left">Variables</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.2462936</td>
<td align="right">0.5328411</td>
<td align="left">NIR1</td>
</tr>
<tr class="even">
<td align="right">0.4613510</td>
<td align="right">0.6554178</td>
<td align="left">NIR2</td>
</tr>
<tr class="odd">
<td align="right">0.5463372</td>
<td align="right">0.7374684</td>
<td align="left">NIR3</td>
</tr>
<tr class="even">
<td align="right">0.5442046</td>
<td align="right">0.8053808</td>
<td align="left">NIR4</td>
</tr>
<tr class="odd">
<td align="right">0.4801735</td>
<td align="right">0.8677665</td>
<td align="left">NIR5</td>
</tr>
<tr class="even">
<td align="right">0.3749901</td>
<td align="right">0.9240111</td>
<td align="left">NIR6</td>
</tr>
</tbody>
</table>
<p>And we can plot it using <code><a href="../reference/geom_corr_circle.html">geom_corr_circle()</a></code>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(fit, <span class="kw">aes</span>(<span class="dt">x =</span> Comp1, <span class="dt">y =</span> Comp2))</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">p <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/geom_corr_circle.html">geom_corr_circle</a></span>()</a></code></pre></div>
<p><img src="ggepi_files/figure-html/corr_circle-1.png" width="672" style="display: block; margin: auto;"></p>
<p>And to customize it:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">p <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/geom_corr_circle.html">geom_corr_circle</a></span>(</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">    <span class="dt">size =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">    <span class="dt">colour =</span> <span class="st">"grey50"</span>,</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">    <span class="dt">outer.linesize =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">    <span class="dt">inner.linesize =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">    <span class="dt">center.linecolour =</span> <span class="st">"grey"</span>,</a>
<a class="sourceLine" id="cb7-7" data-line-number="7">    <span class="dt">center.linesize =</span> <span class="fl">0.3</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8">    ) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="st">    </span><span class="kw">theme_classic</span>()</a></code></pre></div>
<p><img src="ggepi_files/figure-html/custom_corr_circle-1.png" width="672" style="display: block; margin: auto;"></p>
<p>If you want to add text to the “highly correlated” variables, I suggest using the <a href="https://cran.r-project.org/web/packages/ggrepel/vignettes/ggrepel.html">ggrepel::geom_text_repel()</a> functions. They are really useful!</p>
</div>
<div id="similar-packages-1" class="section level2">
<h2 class="hasAnchor">
<a href="#similar-packages-1" class="anchor"></a>Similar packages</h2>
<p>These other packages have similar functionality.</p>
<ul>
<li>
<a href="https://github.com/vqv/ggbiplot">ggbiplot</a> package</li>
<li>
<a href="https://github.com/kassambara/factoextra">factoextra</a> package</li>
<li>
<code>biplot.princomp()</code> function in base R</li>
</ul>
<p>However, these packages again assume you are plotting directly from a <code>prcomp()</code> or <code><a href="http://www.rdocumentation.org/packages/pls/topics/mvr">pls::plsr()</a></code> output, so they do a lot of internal data wrangling. Sometimes you may want more control over what data is plotted. Customizing the display of the plots from these other packages or functions can also be a bit difficult. Here, ggepi is as hands off as possible. You have control over what is plotted and how it looks.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#estimates-and-confidence-intervals-from-regression-models">Estimates and confidence intervals from regression models</a><ul class="nav nav-pills nav-stacked">
<li><a href="#similar-packages">Similar packages</a></li>
      </ul>
</li>
      <li>
<a href="#dimensionality-reduction-techniques">Dimensionality reduction techniques</a><ul class="nav nav-pills nav-stacked">
<li><a href="#correlation-circle">Correlation circle</a></li>
      <li><a href="#similar-packages-1">Similar packages</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Luke Johnston.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
